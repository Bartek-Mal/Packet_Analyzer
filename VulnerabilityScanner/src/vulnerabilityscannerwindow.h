#ifndef VULNERABILITYSCANNERWINDOW_H
#define VULNERABILITYSCANNERWINDOW_H

#include <QMainWindow>

class QTabWidget;
class QWidget;
class QLineEdit;
class QPushButton;
class QTableView;
class QPlainTextEdit;
class QTextEdit;
class QProcess;

class VulnerabilityScannerWindow : public QMainWindow {
    Q_OBJECT
public:
    explicit VulnerabilityScannerWindow(QWidget *parent = nullptr);

private slots:
    void runSqlScan();
    void runXssScan();
    void runSstiScan();
    void runCustomScan();
    void browseCustomScript();
    void startProxyScanner();

private:
    QTabWidget    *tabs{nullptr};

    // SQLi tab
    QWidget       *sqlTab{nullptr};
    QLineEdit     *sqlUrlEdit{nullptr};
    QLineEdit     *sqlParamsEdit{nullptr};
    QPushButton   *sqlRunBtn{nullptr};
    QTableView    *sqlResultsView{nullptr};

    // XSS tab
    QWidget       *xssTab{nullptr};
    QLineEdit     *xssUrlEdit{nullptr};
    QLineEdit     *xssParamEdit{nullptr};
    QPushButton   *xssRunBtn{nullptr};
    QTableView    *xssResultsView{nullptr};

    // SSTI tab
    QWidget        *sstiTab{nullptr};
    QLineEdit      *sstiUrlEdit{nullptr};
    QLineEdit      *sstiPayloadEdit{nullptr};
    QPushButton    *sstiRunBtn{nullptr};
    QPlainTextEdit *sstiOutput{nullptr};

    // Custom scripts tab
    QWidget        *customTab{nullptr};
    QLineEdit      *customScriptEdit{nullptr};
    QPushButton    *customBrowseBtn{nullptr};
    QPushButton    *customRunBtn{nullptr};
    QPlainTextEdit *customOutput{nullptr};

    // Proxy control tab
    QWidget      *proxyTab{nullptr};
    QPushButton  *proxyStartBtn{nullptr};
    QTextEdit    *proxyLogView{nullptr};
    QProcess     *proxyProcess{nullptr};
};

#endif // VULNERABILITYSCANNERWINDOW_H
